<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>

<style>

	@import 'reset.css';
	@import 'setup.css';

	/*Dealing with the particular <details> element issue on this site.*/

	details div {
		box-sizing: border-box;
	}

	/*Keyframes*/

	@keyframes colorChangeOne {
		0% {
			border: 3px solid red;
		}
		
		14% {
			border: 3px solid orange;
		}
		
		29% {
			border: 3px solid yellow;
		}
		
		43% {
			border: 3px solid lime;
		}

		57% {
			border: 3px solid blue;
		}
		
		71% {
			border: 3px solid indigo;
		}
		
		86% {
			border: 3px solid violet;
		}
		
		100% {
			border: 3px solid red;
		}
	}

	@keyframes borderColorChangeTwo {
		0% {
			border: 3px solid var(--desire);
		}

		50% {
			border: 3px solid cyan;
		}

		100% {
			border: 3px solid var(--desire);
		}
	}

	@keyframes rotate {
	  0% {
	    transform: rotate(0);
	  }
	  100% {
	    transform: rotate(90deg);
	  }
	}


	/*Typography*/

	h1 {
		letter-spacing: 0.06em;
	}

	h2 {
		font-size: 1.5rem;
	}

	.category, .favorites {
		letter-spacing: 0.06em;
	}

	/*Page Styles*/

	html {
		--neonFuchsia: #ff4560;
		--sweetcorn: #f6e579;
		--falured: #81201b;
		--phthaloblue: #04167d;
		--gulfblue: #00175c;
		--tolopea: #160f46;
		--desire: #e23f53;
		--cgred: #dd3b30;
		--palegreen: #95f598;
		--fadedlime: #7df383;
		--anakiwa: #8acde4;
		--lightgreen: #4af2a1;
		--amazon: #36745c;
		--rajah: #ffa863;
		--peach: #ffcfa9;

		--defaultSpacing: 20px;
		color: black;
		font-family: 'Arial', sans-serif;
	}

	body {
/*		padding: 5px;*/
/*		display: grid;
		grid-template-rows: auto 1fr;*/
		background-color: white;
		padding: var(--defaultSpacing);
		overflow-y: scroll;
	}

	main {
		margin-top: 18px;
	}

	inner-column {
		display: block;
		margin: 0 auto;
		max-width: 720px;
	}


	/*Header styles*/

	header inner-column {
		display: grid;
		grid-template-columns: auto 1fr auto;
		grid-gap: var(--defaultSpacing);
/*		padding: 18px;*/
	}

	header inner-column img-wrapper {
		display: block;
		width: 53px;

	}

	img-wrapper img {
		border: 2px solid black;
		border-radius: 100%;
	}


	header inner-column h1 {
		align-self: center;
		text-transform: uppercase;
	}


	nav {
		display: grid;
	}

	nav ul {
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		gap: 1rem;
		align-items: center;
		justify-content: space-evenly;
	}

	.category, .favorites {
		padding: var(--defaultSpacing);
	}

	/*.category h2 {
		font-size: 1.5rem;
	}*/

	/*.category, .product-list li {
		animation-name: borderColorChangeTwo;
		animation-iteration-count: infinite;
		animation-duration: 6s;
	}*/

	.category {
		border-top: 2px solid black;
		border-right: 2px solid black;
		border-left: 2px solid black;
	}

	.category:last-of-type {
		border-bottom: 2px solid black;
	}


	/*SVG attributes*/

	icon-wrapper {
		display: block;
		width: 23px;
		margin-left: auto;
	}
	.arrow path {
		stroke: black;
		stroke-width: 20px;
	}

	.arrow path {
		fill: red;
	}

	details[open] .arrow {
		transform: rotate(90deg);
	}

	details[open] .arrow path {
		fill: lime;
	}

	/*Product List*/


	.product-list {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
		gap: var(--defaultSpacing);
		margin-top: 10px;
	}

	.product-list li  {
		place-self: center;
		border: 1px solid black;
/*		padding: 8px;*/
		max-width: 232px;
		box-shadow: 3px 3px;
	}


	summary {
		display: grid;
		grid-template-columns: 1fr 1fr;
	}

	summary h2 {
		align-self: center;
	}

	/*Product Card Styles*/

	product-card {
		display: grid;
		grid-template-rows: auto 1fr auto;
		height: 100%;
	}

	product-card picture {
		position: relative;
		border: 1px solid black;
	}

	product-card button {
		position: absolute;
		top: 4%;
		right: 2%;
	}

	button.favorited, button.not-favorited {
		width: 58px;
	}

	product-card .item-name {
		font-style: italic;
		padding: 8px 8px 0px 8px;
	}

	product-card .prices {
		padding: 8px;
	}

	product-card text-wrapper {
		display: block;
/*		border: 3px solid cyan; */
	}

/*	product-card card-bottom {
		display: grid;
		grid-template-rows: 1fr auto;
		height: 100%;
	}
*/
	card-bottom .prices {
		display: flex;
		flex-direction: row;
		justify-content: space-evenly;
	}

	card-bottom div.price p {
		text-decoration: line-through;
	}

	card-bottom div.sale p {
		font-weight: 700;
	}

	button {
		border: none;
		background: none;
	}

	button.favorited svg, button.not-favorited svg {
		stroke: black;
		stroke-width: 12.25px;
	}

	button.favorited svg path {
		fill: red;
	}

	button.not-favorited svg path {
		fill: none;
	}








/*Favorites Page*/

.favorites {
	border: 2px solid black;
}


</style>


</head>
<body>
	<header>
		<inner-column>
			<img-wrapper class='road-icon'>
				<img id="home" src="photos/Eye-of-Horus.jpg" alt="Eye of Horus icon">
			</img-wrapper>

			<h1 class='title'>Front End Engineer Challenge</h1>
			
		<!-- 	<button class='toggle menu-icon'>
				<?php include('./images/menu-icon.php'); ?>
			</button> -->
			
			<nav class="site-menu">
				<ul>
					<li><a id="about" href=''>About</a></li>
					<li><a id="favorites" href='#'>Favorites</a></li>
					<li><a id="contact" href='#'>Contact</a></li>
				</ul>
				<!-- <button class="toggle small-screen">Close</button> -->
			</nav>
		</inner-column>
	</header>
	<main><inner-column class="main"></inner-column></main>

<script src="functions.js"></script>
<script>
	
console.clear();

//Initialize local storage and place all favorites data and open menus into an accessible object.
var favorites = JSON.parse( localStorage.getItem('favorites') ) || [];
var openMenus = JSON.parse( localStorage.getItem('openMenus') ) || [];

//Set up an area to put event listeners.
const header = document.querySelector('header');
const outlet = document.querySelector('.main');

//imported function
renderData();

console.log(favorites);

outlet.addEventListener('click', (event) => {

	//Initial variables to use in DOM and event listeners
	const categoryId = event.target.closest('.category')?.dataset.id;
	const price = outlet.querySelector('.price').textContent; 
	const sale = outlet.querySelector('.sale').textContent;


	if(event.target.tagName === 'BUTTON') {

		const productId = event.target.closest('product-card').dataset.id;

		if(event.target.className === 'not-favorited') {
			
			const product = {
				category: categoryId,
				name: productId,
				price: price,
				sale: sale,
				isFavorited: true,
			}

			favorites.push(product);
			localStorage.setItem('favorites', JSON.stringify(favorites));
			console.log(`${productId} was added to local storage successfully`, favorites);
	
			event.target.className = 'favorited';

		} else if(event.target.className === 'favorited') {

			const filtered = favorites.filter(product => product.name != productId);
			favorites = [...filtered];

			localStorage.setItem('favorites', JSON.stringify(favorites));
			console.log(`${productId} was removed from local storage.`, favorites)

			event.target.className = 'not-favorited';

			//Re-render the updated favorites page, as the data might have changed!!
			renderFavoritesView();
		}
	}
})

outlet.addEventListener('click', (event) => {

	//Event listener variables.  Order them in DOM order.
	const categoryId = event.target.closest('.category')?.dataset.id;
	const details = event.target.closest('details');
		
	if(event.target.tagName === 'ICON-WRAPPER') {
	
		if(!details.open) {
			//add the menu's data-id to local storage
			openMenus.push(categoryId);
			localStorage.setItem('openMenus', JSON.stringify(openMenus));
			console.log('This menu is open and it\'s been stored in local storage!');			
		} else {
			//remove the menu's data-id from local storage	
			const filtered = openMenus.filter(menuName => menuName != categoryId);
			openMenus = [...filtered];

			localStorage.setItem('openMenus', JSON.stringify(openMenus));
			console.log('This menu is closed and it\'s been removed from local storage!');	
		}
	}
})

header.addEventListener('click', (event) => {
	event.preventDefault();
	if(event.target.id === 'about') {
		renderAboutPage();
	}

	if(event.target.id === 'home') {
		renderData();
	}

	if(event.target.id === 'favorites') {
		renderFavoritesView();
	}
})


	//Next, the rendered data has to reflect what's present in local storage, i.e. the favorites buttons have to be on if the objects are in there.  You'll need a renderFavorites() function that runs close to the beginning of the app.

	//All that needs to be on the page visually is that the favorites button needs the right class.

</script>
</body>
</html>


	